{"version":3,"sources":["main.js"],"names":["$","DATABASE_NAME","STORE_NAME","TEAM_ENTRY","TEAM_MEMBER_COUNT","CHARACTERS","id","name","image","charas","forEach","chara","count","tmpl","members","Array","appendTo","optionsHTML","i","len","length","character","$options","each","select","append","clone","on","prop","changeForm","lastModifyEntryKey","database","firebase","ref","teamsRef","child","singlesRef","entries","configRef","config","once","snapshot","val","open","adminPass","set","configUpdated","show","hide","teamNo","teams","team","key","no","toTemplateFormat","fadeIn","prependTo","addOption","push","teamUpdated","singles","single","singleUpdated","remove","removeOption","splice","old","replaceWith","changeOptionLabel","e","preventDefault","collapse","enableActionButtons","hideMessages","isMediation","validate","data","getFormData","dataRef","onComplete","trigger","showMessage","setTimeout","modal","showMessage2","password","md5","entry","setFormData","text","removeClass","pass","comfirmDelete","href","replace","scrollTo","type","enabled","isEdit","num","updatedAt","Date","toString","twitter","comment","selector","label","value","reverse","prepend","find","option","message","fadeOut","empty","className","addClass","handle","div","span","button","cancel","adjust","animate","scrollTop","eq","offset","top","document","hasClass","focus","style","cssText","reset","urlReplace","attr","history","pushState","location","hash","back","updateTotalCount","getDateString","analytics","upCountTask","totalCount","member","click","target","clearFormPlayer","selectedIndex","task","clearTimeout","pCharas","extend","pCharasArray","sortByCount","objectToArray","displayCharaCount","object","array","sort","a","b","selecter","totalSelecter","date","undefined","getFullYear","padLeft","getMonth","getDate","getHours","getMinutes","getSeconds","str","pad","buf","slice","charaBlank","charaName","charaIcon"],"mappings":"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","file":"main.js","sourcesContent":["$(function(){\n  const DATABASE_NAME = 'apocalypse';\n  const STORE_NAME = '1';\n  const TEAM_ENTRY = true; // 現在はチーム戦のみ対応\n  const TEAM_MEMBER_COUNT = 5;\n\n  var CHARACTERS = [\n    {\n      id: 'anakaris',\n      name: 'アナカリス',\n      image: 'img_s_anakaris_50x50.jpg'\n    }, {\n      id: 'aulbath',\n      name: 'オルバス',\n      image: 'img_s_aulbath_50x50.jpg'\n    }, {\n      id: 'bishamon',\n      name: 'ビシャモン',\n      image: 'img_s_bishamon_50x50.jpg'\n    }, {\n      id: 'bulleta',\n      name: 'バレッタ',\n      image: 'img_s_bulleta_50x50.jpg'\n    }, {\n      id: 'demitri',\n      name: 'デミトリ',\n      image: 'img_s_demitri_50x50.jpg'\n    }, {\n      id: 'felicia',\n      name: 'フェリシア',\n      image: 'img_s_felicia_50x50.jpg'\n    }, {\n      id: 'gallon',\n      name: 'ガロン',\n      image: 'img_s_gallon_50x50.jpg'\n    }, {\n      id: 'jedah',\n      name: 'ジェダ',\n      image: 'img_s_jedah_50x50.jpg'\n    }, {\n      id: 'leilei',\n      name: 'レイレイ',\n      image: 'img_s_leilei_50x50.jpg'\n    }, {\n      id: 'lilith',\n      name: 'リリス',\n      image: 'img_s_lilith_50x50.jpg'\n    }, {\n      id: 'morrigan',\n      name: 'モリガン',\n      image: 'img_s_morrigan_50x50.jpg'\n    }, {\n      id: 'qbee',\n      name: 'キュービー',\n      image: 'img_s_qbee_50x50.jpg'\n    }, {\n      id: 'sasquatch',\n      name: 'サスカッチ',\n      image: 'img_s_sasquatch_50x50.jpg'\n    }, {\n      id: 'victor',\n      name: 'ビクトル',\n      image: 'img_s_victor_50x50.jpg'\n    }, {\n      id: 'zabel',\n      name: 'ザベル',\n      image: 'img_s_zabel_50x50.jpg'\n    }\n  ];\n\n  // ハッシュ作成\n  var charas = {}\n  CHARACTERS.forEach(chara => {\n    charas[chara.id] = {\n      name: chara.name,\n      image: chara.image,\n      count: 0\n    };\n  });\n\n  // フォーム生成\n  $('#template-team-member-form').tmpl({\n      members: new Array(TEAM_MEMBER_COUNT)\n    })\n    .appendTo('.team-member-form');\n\n  // 使用キャラ選択の作成\n  var optionsHTML = '';\n  for (var i = 0, len = CHARACTERS.length; i < len; i++) {\n    var character = CHARACTERS[i];\n    optionsHTML +=\n      '<option value=\"' + character.id + '\">' + character.name + '</option>';\n  }\n  var $options = $(optionsHTML);\n  $('select.characters').each(function(i, select) {\n    $(select).append($options.clone());\n  });\n\n  // フォーム切替\n  $('input[name=entry-type]').on('change', function() {\n    if ($('#type-single').prop('checked')) {\n      changeForm('single');\n    } else {\n      changeForm('team');\n    }\n  });\n\n  var lastModifyEntryKey = '';\n\n  // firebase\n  var database = firebase.database();\n  var ref = database.ref(`${DATABASE_NAME}/${STORE_NAME}`);\n  var teamsRef = ref.child('teams');\n  var singlesRef = ref.child('singles');\n  var entries = {};\n\n  // 設定\n  var configRef = ref.child('config');\n  var config;\n  configRef.child('open');\n  configRef.once('value', function(snapshot) {\n    config = snapshot.val();\n    if (!config) {\n      config = {\n        open: true,\n        adminPass: 'e421b0ade1927b91fa41bfa2baf72eb5'\n      }\n      configRef.set(config);\n    }\n    configUpdated(config);\n    configRef.on('value', function(snapshot) {\n      config = snapshot.val();\n      configUpdated(config);\n    });\n  });\n\n  // 設定変更時\n  function configUpdated(config) {\n    if (config.open) {\n      $('.entry-open').show();\n      $('.entry-close').hide();\n    } else {\n      $('.entry-open').hide();\n      $('.entry-close').show();\n    }\n  }\n\n  // 追加\n  var teamNo = 0;\n  var teams = [];\n  teamsRef.on('child_added', function(snapshot) {\n    var team = snapshot.val();\n    var key = snapshot.key;\n    team.no = ++teamNo;\n    team.key = key;\n    $('#template-team').tmpl(toTemplateFormat(team, TEAM_MEMBER_COUNT)).fadeIn(1000).prependTo('#teams');\n\n    entries[key] = team;\n    addOption('#target-team', team.name, key, true);\n    teams.push(team);\n    teamUpdated(team);\n  });\n  var singles = [];\n  singlesRef.on('child_added', function(snapshot) {\n    var single = snapshot.val();\n    var key = snapshot.key;\n    single.key = key;\n    $('#template-single').tmpl(toTemplateFormat(single, 1)).fadeIn(1000).prependTo('#singles');\n    entries[key] = single;\n    addOption('#target-single', single.members[0].name, key, true);\n    singles.push(single);\n    singleUpdated(single);\n  });\n\n  // 削除\n  teamsRef.on('child_removed', function(snapshot) {\n    var key = snapshot.key;\n    $('#' + key).remove();\n    removeOption('#target-team', key);\n    delete entries[key];\n    for (var i = 0, len = teams.length; i < len; i++) {\n      if (teams[i].key === key) {\n        teams.splice(i, 1);\n        break;\n      }\n    }\n    teamUpdated();\n  });\n  singlesRef.on('child_removed', function(snapshot) {\n    var key = snapshot.key;\n    $('#' + key).remove();\n    removeOption('#target-single', key);\n    delete entries[key];\n    for (var i = 0, len = singles.length; i < len; i++) {\n      if (singles[i].key === key) {\n        singles.splice(i, 1);\n        break;\n      }\n    }\n    singleUpdated();\n  });\n\n  // 変更\n  teamsRef.on('child_changed', function(snapshot, old) {\n    var team = snapshot.val();\n    var key = snapshot.key;\n    team.no = entries[key].no;\n    team.key = key;\n\n    $('#' + key).replaceWith($('#template-team').tmpl(toTemplateFormat(team, TEAM_MEMBER_COUNT)).fadeIn(1000));\n\n    entries[key] = team;\n    changeOptionLabel('#target-team', team.name, key);\n    for (var i = 0, len = teams.length; i < len; i++) {\n      if (teams[i].key === key) {\n        teams[i] = team;\n        break;\n      }\n    }\n    teamUpdated(team);\n  });\n  singlesRef.on('child_changed', function(snapshot, old) {\n    var single = snapshot.val();\n    var key = snapshot.key;\n    single.key = key;\n    $('#' + key).replaceWith($('#template-single').tmpl(toTemplateFormat(single, 1)).fadeIn(1000));\n    entries[key] = single;\n    changeOptionLabel('#target-single', single.members[0].name, key);\n    for (var i = 0, len = singles.length; i < len; i++) {\n      if (singles[i].key === key) {\n        singles[i] = single;\n        break;\n      }\n    }\n    singleUpdated(single);\n  });\n\n\n  // エントリー（保存）\n  $('#entry-button').on('click', function(e) {\n    e.preventDefault();\n    $('#edit-form').collapse('hide');\n    enableActionButtons(false);\n    hideMessages();\n\n    // validate\n    var isMediation = $('#type-single').prop('checked');\n    if (!validate(isMediation)) {\n      enableActionButtons(true);\n      return false;\n    }\n    var data = getFormData();\n    var dataRef;\n    if (isMediation) {\n      dataRef = singlesRef.push(data, onComplete);\n    } else {\n      dataRef = teamsRef.push(data, onComplete);\n    }\n\n    function onComplete() {\n      $('#type-team').trigger('change');\n      showMessage('success', 'エントリーが完了しました', true);\n      $('.team-entry-form > .form-group').hide();\n      setTimeout(function(){\n        $('#team-entry').modal('hide');\n      }, 1500);\n      lastModifyEntryKey = dataRef.key;\n    }\n  });\n\n  // 編集・削除の入力\n  $('#input-button').on('click', function(e){\n    e.preventDefault();\n    hideMessages();\n\n    if ($('#target').prop('selectedIndex') === 0) {\n      showMessage2('danger', '対象のエントリーを選択してください');\n      return false;\n    }\n    if ($('#input-pass').val().length === 0) {\n      showMessage2('danger', 'パスワードを入力してください');\n      return false;\n    }\n\n    var key = $('#target').val();\n    var password = md5($('#input-pass').val());\n    var entry = entries[key];\n    if (entry.password === password || config.adminPass === password) {\n      // エントリー情報セット\n      setFormData(entry, key);\n      $('#message').hide();\n      $('#entry-button').hide();\n      $('#edit-button').show();\n      $('#delete-button').show();\n      $('#entry-form-title').text('エントリーの編集・削除');\n      $('.entry-explain').hide();\n      $('.pass .badge').hide();\n      $('#pass').removeClass('require').prop('placeholder', 'パスワードを変更する');\n      $('#team-entry').removeClass('edit');\n      hideMessages();\n    } else {\n      showMessage2('danger', 'パスワードが違います');\n      return false;\n    }\n  });\n\n  // 編集する\n  $('#edit-button').on('click', function(e) {\n    e.preventDefault();\n\n    enableActionButtons(false);\n    hideMessages();\n\n    // validate\n    var key = $('#key').val();\n    if (key.length === 0) {\n      showMessage('danger', 'エラーが発生しました。もう一度最初からやり直してください');\n      enableActionButtons(true);\n      return false;\n    }\n    var isMediation = $('#type-single').prop('checked');\n    if (!validate(isMediation, true)) {\n      enableActionButtons(true);\n      return false;\n    }\n\n\n    var data = getFormData();\n    var dataRef;\n\n    // パスワードの入力がなければ旧パスワードのまま\n    var pass = $('#pass').val();\n    if (pass.length !== 0) {\n      data.password = md5(pass);\n    } else {\n      data.password = entries[key].password;\n    }\n    var dataRef;\n    if (!entries[key].name && !isMediation) {\n      // 斡旋からチームエントリー\n      dataRef = singlesRef.child(key);\n      dataRef.set(null);\n      dataRef = teamsRef.push(data, onComplete);\n    } else if (entries[key].name && isMediation) {\n      // チームエントリーから斡旋\n      dataRef = teamsRef.child(key);\n      dataRef.set(null);\n      dataRef = singlesRef.push(data, onComplete);\n    } else if (isMediation) {\n      // 斡旋から斡旋\n      dataRef = singlesRef.child(key);\n      dataRef.set(data, onComplete);\n    } else {\n      // チームエントリーからチームエントリー\n      dataRef = teamsRef.child(key);\n      dataRef.set(data, onComplete);\n    }\n    function onComplete() {\n      showMessage('success', '編集が完了しました', true);\n      $('.team-entry-form > .form-group').hide();\n      setTimeout(function(){\n        $('#team-entry').modal('hide');\n      }, 1500);\n      lastModifyEntryKey = dataRef.key;\n    }\n  });\n\n  // 削除する\n  $('#delete-button').on('click', function(e) {\n    e.preventDefault();\n\n    enableActionButtons(false);\n    // validate\n    var key = $('#key').val();\n    if (key.length === 0) {\n      showMessage('danger', 'エラーが発生しました。もう一度最初からやり直してください');\n      enableActionButtons(true);\n      return false;\n    }\n    comfirmDelete(function(e){\n      e.preventDefault();\n      var isMediation = $('#type-single').prop('checked');\n      var dataRef;\n      if (isMediation) {\n        dataRef = singlesRef.child(key);\n        dataRef.set(null, onComplete);\n      } else {\n        dataRef = teamsRef.child(key);\n        dataRef.set(null, onComplete);\n      }\n    });\n\n    function onComplete() {\n      showMessage('success', '削除が完了しました', true);\n      $('.team-entry-form > .form-group').hide();\n      setTimeout(function(){\n        $('#team-entry').modal('hide');\n      }, 1500);\n    }\n  });\n\n  // スムーズスクロール\n  $('.anchor-button').on('click', function(e) {\n    e.preventDefault();\n    var href = '#' + this.href.replace(/.*#/, '');\n    scrollTo(href, -70);\n  });\n\n  function hideMessages() {\n    $('#message').hide();\n    $('#message2').hide();\n  }\n\n  function changeForm(type) {\n    if (type === 'single') {\n      $('#member1').show();\n      $('#member1 > legend').hide();\n      $('#member2').hide();\n      $('#member3').hide();\n      $('#team-name').hide();\n      $('.pass').show();\n    } else {\n      $('#member1').show();\n      $('#member1 > legend').show();\n      $('#member2').show();\n      $('#member3').show();\n      $('#team-name').show();\n      $('.pass').show();\n    }\n  }\n\n  function enableActionButtons(enabled) {\n    $('#entry-button').prop('disabled', !enabled);\n    $('#edit-button').prop('disabled', !enabled);\n    $('#delete-button').prop('disabled', !enabled);\n    $('#cancel-button').prop('disabled', !enabled);\n  }\n\n  function validate(isMediation, isEdit) {\n    if (typeof isEdit == 'undefined') {\n      isEdit = false\n    }\n    if (!isMediation) {\n      if ($('#teamName').val().length === 0) {\n        showMessage('danger', 'チーム名を入力してください');\n        return false;\n      }\n    }\n    if ($('#member1-name').val().length === 0) {\n      showMessage('danger', '1人目のプレイヤー名を入力してください');\n      return false;\n    }\n    if ($('#member1-character').prop('selectedIndex') === 0) {\n      showMessage('danger', '1人目の使用キャラを選択してください');\n      return false;\n    }\n    if (!isMediation) {\n      for (let i = 1; i < TEAM_MEMBER_COUNT; i++) {\n        let num = i + 1;\n          if ( $(`#member${num}-name`).val() ||\n            $(`#member${num}-character`).prop('selectedIndex') !== 0 ||\n            $(`#member${num}-comment`).val() ||\n            $(`#member${num}-join-ok`).prop('checked') ||\n            $(`#member${num}-join-ng`).prop('checked')\n          ) {\n            if ($(`#member${num}-name`).val().length === 0) {\n              showMessage('danger', `${num}人目のプレイヤー名を入力してください`);\n              return false;\n            }\n            if ($(`#member${num}-character`).prop('selectedIndex') === 0) {\n              showMessage('danger', `${num}人目の使用キャラを選択してください`);\n              return false;\n            }\n          }\n      }\n    }\n    if (!isEdit && $('#pass').val().length === 0) {\n      showMessage('danger', '削除・編集用のパスワードを入力してください');\n      return false;\n    }\n    return true;\n  }\n\n  function getFormData() {\n    // must inputs\n    var data = {\n      updatedAt: new Date().toString(),\n      password: md5($('#pass').val()),\n      members: []\n    }\n\n    for (let i = 0; i < TEAM_MEMBER_COUNT; i++) {\n      let num = i + 1;\n      if ($(`#member${num}-name`).val()) {\n        data.members.push({\n          name: $(`#member${num}-name`).val(),\n          character: $(`#member${num}-character`).val(),\n          twitter: $(`#member${num}-twitter`).val(),\n          comment: $(`#member${num}-comment`).val().replace(/[\\n\\r]/g, ''),\n          // after: $(`input[name=member${num}-after]:checked`).val() || ''\n        });\n      }\n    }\n\n    if ($('#type-team').prop('checked')) {\n      // チーム名\n      data.name = $('#teamName').val();\n    }\n    return data;\n  }\n\n  function setFormData(entry, key) {\n    $('#key').val(key || '');\n\n    for (let i = 0; i < entry.members.length; i++) {\n      let num = i + 1;\n      $(`#member${num}-name`).val(entry.members[i].name);\n      $(`#member${num}-character`).val(entry.members[i].character || '選択してください');\n      $(`#member${num}-twitter`).val(entry.members[i].twitter);\n      $(`#member${num}-comment`).val(entry.members[i].comment);\n      // let after = entry.members[i].after;\n      // if (after) {\n      //   if (after == 1) {\n      //     $(`#member${num}-join-ok`).prop('checked', true);\n      //   } else {\n      //     $(`#member${num}-join-ng`).prop('checked', true);\n      //   }\n      // }\n    }\n\n    if (entry.name && entry.name.length !== 0) {\n      $('#type-team').prop('checked', true).trigger('change');\n      $('#teamName').val(entry.name);\n    } else {\n      $('#type-single').prop('checked', true).trigger('change');\n    }\n  }\n\n  function addOption(selector, label, value, reverse) {\n    if (reverse) {\n      $(selector).prepend($('<option/>').text(label).val(value));\n    } else {\n      $(selector).append($('<option/>').text(label).val(value));\n    }\n  }\n\n  function removeOption(selector, value) {\n    $(selector).find('option').each(function(i, option) {\n      if (option.value === value) {\n        $(option).remove();\n        return;\n      }\n    });\n  }\n  function changeOptionLabel(selector, label, value) {\n    $(selector).find('option').each(function(i, option) {\n      if (option.value === value) {\n        $(option).text(label);\n        return;\n      }\n    });\n  }\n\n  function showMessage(type, message, fadeOut) {\n    $('#message').empty();\n    // if (typeof fadeOut === 'undefined') {\n    //   fadeOut = false;\n    // }\n    $('#message')[0].className = '';\n    $('#message').text(message).addClass('alert alert-' + type).show();\n    // if (fadeOut) {\n    //   setTimeout(function(){\n    //     $('#message').fadeOut(1000);\n    //   }, 3000);\n    // }\n  }\n\n  function showMessage2(type, message, fadeOut) {\n    $('#message2').empty();\n    // if (typeof fadeOut === 'undefined') {\n    //   fadeOut = false;\n    // }\n    $('#message2')[0].className = '';\n    $('#message2').text(message).addClass('alert alert-' + type).show();\n    // if (fadeOut) {\n    //   setTimeout(function(){\n    //     $('#message2').fadeOut(1000);\n    //   }, 3000);\n    // }\n  }\n\n  function comfirmDelete(handle) {\n    $('#message').empty();\n    var div = $('<div/>');\n    var span = $('<span/>').text('エントリーを削除します。よろしいですか？');\n    var button = $('<a href=\"#\"/>').addClass('btn btn-danger btn-sm').text('はい').on('click', handle);\n    var cancel = $('<a href=\"#\"/>').addClass('btn btn-default btn-sm').text('いいえ').on('click', function(e){\n      e.preventDefault();\n      $('#message').hide();\n    });\n    div.append(span);\n    div.append(button);\n    div.append(cancel);\n    $('#message')[0].className = '';\n    $('#message').append(div).addClass('alert alert-danger').show();\n  }\n\n  function scrollTo(selector, adjust) {\n    $(\"html,body\").animate({scrollTop:$(selector).eq(0).offset().top + adjust});\n  }\n\n  $('.to-edit-form').on('click', function(e) {\n    e.preventDefault();\n    $('#team-entry').addClass('edit').modal();\n  });\n  $('.to-entry-form').on('click', function(e) {\n    e.preventDefault();\n    $('#team-entry').removeClass('edit').modal();\n  });\n  $(document).on('click', '.edit-link', function(e) {\n    e.preventDefault();\n    $('#target').val($(this).data('id'));\n    $('#team-entry').addClass('edit').modal();\n  });\n  $('#team-entry').on('shown.bs.modal', function (e) {\n    if ($('#team-entry').hasClass('edit')) {\n      if ($('#target').prop('selectedIndex') !== 0) {\n        $('#input-pass').focus();\n      } else {\n        $('#target').focus();\n      }\n    }\n  });\n  $('#team-entry').on('hidden.bs.modal', function(e) {\n    $('#entry-form-title').text('エントリー');\n    $('#entry-button')[0].style.cssText = '';\n    $('.entry-explain')[0].style.cssText = '';\n    $('#edit-button')[0].style.cssText = '';\n    $('#delete-button')[0].style.cssText = '';\n    $('.pass .badge')[0].style.cssText = '';\n    $('#pass').addClass('require').prop('placeholder', '');\n    $('.team-entry-form')[0].reset();\n    $('.team-entry-form > .form-group')[0].style.cssText = '';\n    $('.edit-form')[0].reset();\n    changeForm();\n    enableActionButtons(true);\n    hideMessages();\n\n    if (lastModifyEntryKey) {\n      var selector = '#' + lastModifyEntryKey;\n      scrollTo(selector, -100);\n      $(selector).addClass('done');\n      setTimeout(function() {\n        $(selector).addClass('animate');\n      }, 100);\n      lastModifyEntryKey = '';\n    }\n  });\n  $('.change-edit-form').on('click', function(e) {\n    e.preventDefault();\n    $('#team-entry').addClass('edit');\n    hideMessages();\n  });\n\n  // modalが表示された時\n  $(\".modal\").on(\"shown.bs.modal\", function() {\n    var urlReplace = \"#\" + $(this).attr('id')\n    history.pushState(null, null, urlReplace)\n  });\n\n  // modalの閉じる機能が動作した時\n  $(\".modal\").on(\"hidden.bs.modal\", function () {\n    if(location.hash == \"#\" + $(this).attr('id')) {\n      history.back()\n    }\n  });\n\n  function teamUpdated(team) {\n    $('.team-entry-count').text(teams.length);\n    updateTotalCount();\n    if (team) {\n      if (team.updatedAt) {\n        $('.team-last-updated-at').text(getDateString(team.updatedAt));\n      }\n    } else {\n      $('.team-last-updated-at').text(getDateString());\n    }\n    analytics();\n  }\n  function singleUpdated(single) {\n    $('.single-entry-count').text(singles.length);\n    updateTotalCount();\n    if (single) {\n      if (single.updatedAt) {\n        $('.single-last-updated-at').text(getDateString(single.updatedAt));\n      }\n    } else {\n      $('.single-last-updated-at').text(getDateString());\n    }\n    analytics();\n  }\n  var upCountTask;\n  function updateTotalCount() {\n    let totalCount = 0;\n    teams.forEach(team => {\n      team.members.forEach(member => {\n        if (member.name) {\n          totalCount++;\n        }\n      });\n    });\n    singles.forEach(team => {\n      team.members.forEach(member => {\n        if (member.name) {\n          totalCount++;\n        }\n      });\n    });\n    $('.total-count').text(totalCount);\n\n    // if (upCountTask) {\n    //   clearTimeout(upCountTask);\n    // }\n    // upCountTask = setTimeout(function() {\n    //   var afterCount = 0;\n    //   for (var key in entries) {\n    //     var entry = entries[key];\n    //     for (var i = 0, len = entry.members.length; i < len; i++) {\n    //       var member = entry.members[i];\n    //       if (member.after == 1) {\n    //         afterCount++;\n    //       }\n    //     }\n    //   }\n    //   $('.after-count').text(afterCount);\n    // }, 1000);\n  }\n\n  $('.clear-button').click((e) => {\n    e.preventDefault();\n    const num = $(e.target).attr('data-target');\n    clearFormPlayer(num);\n  })\n\n  function clearFormPlayer(num) {\n    if (!num) {\n      return;\n    }\n    $('#member' + num + '-name').val('');\n    $('#member' + num + '-character')[0].selectedIndex = 0;\n    $('#member' + num + '-comment').val('');\n    $('#member' + num + '-join-ok').prop('checked', false);\n    $('#member' + num + '-join-ng').prop('checked', false);\n    $('#member' + num + '-twitter').val('');\n  }\n\n  var task;\n  function analytics() {\n    if (task) {\n      clearTimeout(task);\n    }\n    task = setTimeout(function() {\n      var pCharas = $.extend(true, {}, charas);\n      for (var key in entries) {\n        var entry = entries[key];\n        for (var i = 0, len = entry.members.length; i < len; i++) {\n          if (pCharas[entry.members[i].character]) {\n            pCharas[entry.members[i].character].count++;\n          }\n        }\n      }\n      var pCharasArray = sortByCount(objectToArray(pCharas));\n      displayCharaCount(pCharasArray, '#character-count');\n\n    }, 1000);\n  }\n  function objectToArray(object) {\n    var array = [];\n    for (var key in object) {\n      array.push(object[key]);\n    }\n    return array;\n  }\n  function sortByCount(array) {\n    return array.sort(function(a,b){\n        if(a.count < b.count) return -1;\n        if(a.count > b.count) return 1;\n        return 0;\n    });\n  }\n  function displayCharaCount(array, selecter, totalSelecter) {\n    $(selecter).empty();\n    var totalCount = 0;\n    for (var i = (array.length-1); i >= 0; i--) {\n      var chara = array[i];\n      $('#character-count-template').tmpl(chara).appendTo(selecter);\n      totalCount += chara.count;\n    }\n    if (totalSelecter) {\n      $(totalSelecter).text(totalCount);\n    }\n  }\n\n  function getDateString(date) {\n    if (date === undefined) {\n      date = new Date();\n    } else if (typeof date === 'string' && date.length !== 0) {\n      date = new Date(date);\n    }\n    if (date) {\n      return date.getFullYear() + '/' +\n              padLeft(date.getMonth() + 1) + '/' +\n              padLeft(date.getDate()) + ' ' +\n              padLeft(date.getHours()) + ':' +\n              padLeft(date.getMinutes()) + ':' +\n              padLeft(date.getSeconds());\n    } else {\n      return '';\n    }\n  }\n  function padLeft(str, len, pad) {\n    if (pad === undefined) {\n      pad = '0';\n    }\n    if (len === undefined) {\n      len = 2;\n    }\n    var buf = ''\n    for (var i = 0; i < len; i++) {\n      buf += pad;\n    }\n    str = pad + str;\n    return str.slice(-len);\n  }\n\n  const charaBlank = {\n    name: '',\n    image: 'blank.png'\n  };\n\n  function toTemplateFormat(data, len) {\n    if (!len) {\n      len = TEAM_MEMBER_COUNT;\n    }\n    for (let i = 0; i < len; i++) {\n      let member = data.members[i];\n      if (!member) {\n        member = {};\n      }\n      member.name = member.name || '';\n      member.comment = member.comment || '';\n      let character = charas[member.character];\n      if (!character) {\n        character = charaBlank;\n      }\n      // member.after = member.after;\n      member.charaName = character.name;\n      member.charaIcon = character.image;\n      data.members[i] = member;\n    }\n    return data;\n  }\n\n  analytics();\n});\n  "],"sourceRoot":"/source/"}